{
  Path newCrawlDb=new Path("crawldb-merge-" + Integer.toString(new Random().nextInt(Integer.MAX_VALUE)));
  JobConf job=new NutchJob(conf);
  job.setJobName("crawldb merge " + output);
  job.setInputFormat(SequenceFileInputFormat.class);
  job.setMapperClass(CrawlDbFilter.class);
  job.setBoolean(CrawlDbFilter.URL_FILTERING,filter);
  job.setBoolean(CrawlDbFilter.URL_NORMALIZING,normalize);
  job.setReducerClass(Merger.class);
  FileOutputFormat.setOutputPath(job,newCrawlDb);
  job.setOutputFormat(MapFileOutputFormat.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(CrawlDatum.class);
  return job;
}
