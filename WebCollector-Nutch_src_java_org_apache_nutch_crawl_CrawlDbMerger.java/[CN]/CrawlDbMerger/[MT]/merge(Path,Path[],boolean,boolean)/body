{
  SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
  long start=System.currentTimeMillis();
  LOG.info("CrawlDb merge: starting at " + sdf.format(start));
  JobConf job=createMergeJob(getConf(),output,normalize,filter);
  for (int i=0; i < dbs.length; i++) {
    if (LOG.isInfoEnabled()) {
      LOG.info("Adding " + dbs[i]);
    }
    FileInputFormat.addInputPath(job,new Path(dbs[i],CrawlDb.CURRENT_NAME));
  }
  JobClient.runJob(job);
  FileSystem fs=FileSystem.get(getConf());
  if (fs.exists(output))   fs.delete(output,true);
  fs.mkdirs(output);
  fs.rename(FileOutputFormat.getOutputPath(job),new Path(output,CrawlDb.CURRENT_NAME));
  long end=System.currentTimeMillis();
  LOG.info("CrawlDb merge: finished at " + sdf.format(end) + ", elapsed: "+ TimingUtil.elapsedTime(start,end));
}
