{
  metadata.clear();
  int sizeOrVersion=in.readInt();
  if (sizeOrVersion < 0) {
    version=sizeOrVersion;
switch (version) {
case VERSION:
      url=Text.readString(in);
    base=Text.readString(in);
  content=new byte[in.readInt()];
in.readFully(content);
contentType=Text.readString(in);
metadata.readFields(in);
break;
default :
throw new VersionMismatchException((byte)VERSION,(byte)version);
}
}
 else {
byte[] compressed=new byte[sizeOrVersion];
in.readFully(compressed,0,compressed.length);
ByteArrayInputStream deflated=new ByteArrayInputStream(compressed);
DataInput inflater=new DataInputStream(new InflaterInputStream(deflated));
readFieldsCompressed(inflater);
}
}
