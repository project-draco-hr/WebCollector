{
  if (args.length != 1) {
    System.err.println("Usage: EncodingDetector <file>");
    System.exit(1);
  }
  Configuration conf=NutchConfiguration.create();
  EncodingDetector detector=new EncodingDetector(NutchConfiguration.create());
  BufferedInputStream istr=new BufferedInputStream(new FileInputStream(args[0]));
  ByteArrayOutputStream ostr=new ByteArrayOutputStream();
  byte[] bytes=new byte[1000];
  boolean more=true;
  while (more) {
    int len=istr.read(bytes);
    if (len < bytes.length) {
      more=false;
      if (len > 0) {
        ostr.write(bytes,0,len);
      }
    }
 else {
      ostr.write(bytes);
    }
  }
  byte[] data=ostr.toByteArray();
  Content content=new Content("","",data,"text/html",new Metadata(),conf);
  detector.autoDetectClues(content,true);
  String encoding=detector.guessEncoding(content,conf.get("parser.character.encoding.default"));
  System.out.println("Guessed encoding: " + encoding);
}
