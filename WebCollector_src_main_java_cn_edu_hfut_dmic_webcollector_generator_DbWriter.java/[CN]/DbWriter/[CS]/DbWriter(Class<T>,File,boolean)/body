{
  this.type=type;
  DatumWriter<T> datumWriter=new ReflectDatumWriter<T>(type);
  dataFileWriter=new DataFileWriter<T>(datumWriter);
  if (!append) {
    if (!dbfile.getParentFile().exists()) {
      dbfile.getParentFile().mkdirs();
    }
    dataFileWriter.create(AvroModel.getSchema(type),dbfile);
  }
 else {
    dataFileWriter.appendTo(dbfile);
  }
}
