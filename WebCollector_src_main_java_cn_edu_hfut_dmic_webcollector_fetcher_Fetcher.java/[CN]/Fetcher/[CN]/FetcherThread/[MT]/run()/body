{
  Page page=new Page();
  page.url=url;
  Page response=null;
  response=HttpUtils.fetchHttpResponse(url,proxy,conconfig,retry);
  if (response == null) {
    Log.Errors("failed ",Fetcher.this.taskname,page.url);
    HandlerUtils.sendMessage(handler,new Message(Fetcher.FETCH_FAILED,page),true);
    return;
  }
  page=response;
  CrawlDatum crawldatum=new CrawlDatum();
  crawldatum.url=url;
  crawldatum.status=Page.FETCHED;
  page.fetchtime=System.currentTimeMillis();
  crawldatum.fetchtime=page.fetchtime;
  Log.Infos("fetch",Fetcher.this.taskname,page.url);
  if (needUpdateDb) {
    try {
      segmengwriter.wrtieFetch(crawldatum);
      String contentType;
      List<String> contentTypeList=page.headers.get("Content-Type");
      if (contentTypeList == null) {
        contentType=null;
      }
 else {
        contentType=contentTypeList.get(0);
      }
      if (isContentStored) {
        Content content=new Content();
        content.url=page.url;
        if (page.content != null) {
          content.content=page.content;
        }
 else {
          content.content=new byte[0];
        }
        content.contentType=contentType;
        segmengwriter.wrtieContent(content);
      }
      if (parsing) {
        Parser parser=ParserFactory.getParser(contentType,page.url);
        if (parser != null) {
          ParseResult parseresult=parser.getParse(page);
          page.parseResult=parseresult;
          segmengwriter.wrtieParse(parseresult);
        }
      }
    }
 catch (    Exception ex) {
      ex.printStackTrace();
    }
  }
  HandlerUtils.sendMessage(handler,new Message(Fetcher.FETCH_SUCCESS,page),true);
}
