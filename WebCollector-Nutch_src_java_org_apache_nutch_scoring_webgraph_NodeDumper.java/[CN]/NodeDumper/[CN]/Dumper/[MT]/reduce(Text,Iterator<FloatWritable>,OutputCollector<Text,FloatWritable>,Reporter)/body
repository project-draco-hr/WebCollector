{
  long numCollected=0;
  float sumOrMax=0;
  float val=0;
  while (values.hasNext() && (numCollected < topn)) {
    val=values.next().get();
    if (sum) {
      sumOrMax+=val;
    }
 else {
      if (sumOrMax < val) {
        sumOrMax=val;
      }
    }
    numCollected++;
  }
  output.collect(key,new FloatWritable(sumOrMax));
}
