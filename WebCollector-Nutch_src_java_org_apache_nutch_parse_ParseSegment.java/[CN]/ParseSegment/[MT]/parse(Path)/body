{
  SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
  long start=System.currentTimeMillis();
  if (LOG.isInfoEnabled()) {
    LOG.info("ParseSegment: starting at " + sdf.format(start));
    LOG.info("ParseSegment: segment: " + segment);
  }
  JobConf job=new NutchJob(getConf());
  job.setJobName("parse " + segment);
  FileInputFormat.addInputPath(job,new Path(segment,Content.DIR_NAME));
  job.set(Nutch.SEGMENT_NAME_KEY,segment.getName());
  job.setInputFormat(SequenceFileInputFormat.class);
  job.setMapperClass(ParseSegment.class);
  job.setReducerClass(ParseSegment.class);
  FileOutputFormat.setOutputPath(job,segment);
  job.setOutputFormat(ParseOutputFormat.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(ParseImpl.class);
  JobClient.runJob(job);
  long end=System.currentTimeMillis();
  LOG.info("ParseSegment: finished at " + sdf.format(end) + ", elapsed: "+ TimingUtil.elapsedTime(start,end));
}
