{
  String urlString=url.toString();
  try {
    URL u=new URL(urlString);
    int redirects=0;
    while (true) {
      FtpResponse response;
      response=new FtpResponse(u,datum,this,getConf());
      int code=response.getCode();
      if (code == 200) {
        return new ProtocolOutput(response.toContent());
      }
 else       if (code >= 300 && code < 400) {
        if (redirects == MAX_REDIRECTS)         throw new FtpException("Too many redirects: " + url);
        u=new URL(response.getHeader("Location"));
        redirects++;
        if (LOG.isTraceEnabled()) {
          LOG.trace("redirect to " + u);
        }
      }
 else {
        throw new FtpError(code);
      }
    }
  }
 catch (  Exception e) {
    return new ProtocolOutput(null,new ProtocolStatus(e));
  }
}
