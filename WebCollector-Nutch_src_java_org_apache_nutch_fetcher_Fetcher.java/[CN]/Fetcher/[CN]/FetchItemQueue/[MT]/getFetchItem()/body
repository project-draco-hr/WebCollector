{
  if (inProgress.get() >= maxThreads)   return null;
  long now=System.currentTimeMillis();
  if (nextFetchTime.get() > now)   return null;
  FetchItem it=null;
  if (queue.size() == 0)   return null;
  try {
    it=queue.remove(0);
    inProgress.incrementAndGet();
  }
 catch (  Exception e) {
    LOG.error("Cannot remove FetchItem from queue or cannot add it to inProgress queue",e);
  }
  return it;
}
