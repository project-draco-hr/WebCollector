{
  this.conf=conf;
  this.maxThreads=conf.getInt("fetcher.threads.per.queue",1);
  queueMode=conf.get("fetcher.queue.mode",QUEUE_MODE_HOST);
  if (!queueMode.equals(QUEUE_MODE_IP) && !queueMode.equals(QUEUE_MODE_DOMAIN) && !queueMode.equals(QUEUE_MODE_HOST)) {
    LOG.error("Unknown partition mode : " + queueMode + " - forcing to byHost");
    queueMode=QUEUE_MODE_HOST;
  }
  LOG.info("Using queue mode : " + queueMode);
  this.crawlDelay=(long)(conf.getFloat("fetcher.server.delay",1.0f) * 1000);
  this.minCrawlDelay=(long)(conf.getFloat("fetcher.server.min.delay",0.0f) * 1000);
  this.timelimit=conf.getLong("fetcher.timelimit",-1);
  this.maxExceptionsPerQueue=conf.getInt("fetcher.max.exceptions.per.queue",-1);
}
