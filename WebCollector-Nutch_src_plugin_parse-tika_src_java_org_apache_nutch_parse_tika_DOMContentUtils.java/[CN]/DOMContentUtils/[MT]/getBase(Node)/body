{
  NodeWalker walker=new NodeWalker(node);
  while (walker.hasNext()) {
    Node currentNode=walker.nextNode();
    String nodeName=currentNode.getNodeName();
    short nodeType=currentNode.getNodeType();
    if (nodeType == Node.ELEMENT_NODE) {
      if ("body".equalsIgnoreCase(nodeName)) {
        return null;
      }
      if ("base".equalsIgnoreCase(nodeName)) {
        NamedNodeMap attrs=currentNode.getAttributes();
        for (int i=0; i < attrs.getLength(); i++) {
          Node attr=attrs.item(i);
          if ("href".equalsIgnoreCase(attr.getNodeName())) {
            try {
              return new URL(attr.getNodeValue());
            }
 catch (            MalformedURLException e) {
            }
          }
        }
      }
    }
  }
  return null;
}
