{
  Path crawldb1=new Path(testDir,"crawldb1");
  Path crawldb2=new Path(testDir,"crawldb2");
  Path output=new Path(testDir,"output");
  createCrawlDb(conf,fs,crawldb1,init1,cd1);
  createCrawlDb(conf,fs,crawldb2,init2,cd2);
  CrawlDbMerger merger=new CrawlDbMerger(conf);
  LOG.fine("* merging crawldbs to " + output);
  merger.merge(output,new Path[]{crawldb1,crawldb2},false,false);
  LOG.fine("* reading crawldb: " + output);
  reader=new CrawlDbReader();
  String crawlDb=output.toString();
  Iterator<String> it=expected.keySet().iterator();
  while (it.hasNext()) {
    String url=it.next();
    LOG.fine("url=" + url);
    CrawlDatum cd=expected.get(url);
    CrawlDatum res=reader.get(crawlDb,url,conf);
    LOG.fine(" -> " + res);
    System.out.println("url=" + url);
    System.out.println(" cd " + cd);
    System.out.println(" res " + res);
    Assert.assertNotNull(res);
    Assert.assertTrue(cd.equals(res));
  }
  reader.close();
  fs.delete(testDir,true);
}
