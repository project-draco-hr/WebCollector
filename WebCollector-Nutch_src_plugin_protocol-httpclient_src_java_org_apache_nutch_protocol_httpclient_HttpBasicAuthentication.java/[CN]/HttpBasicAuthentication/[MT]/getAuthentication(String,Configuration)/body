{
  if (challenge == null)   return null;
  Matcher basicMatcher=basic.matcher(challenge);
  if (basicMatcher.matches()) {
    String realm=basicMatcher.group(1);
    Object auth=authMap.get(realm);
    if (auth == null) {
      HttpBasicAuthentication newAuth=null;
      try {
        newAuth=new HttpBasicAuthentication(realm,conf);
      }
 catch (      HttpAuthenticationException hae) {
        if (LOG.isTraceEnabled()) {
          LOG.trace("HttpBasicAuthentication failed for " + challenge);
        }
      }
      authMap.put(realm,newAuth);
      return newAuth;
    }
 else {
      return (HttpBasicAuthentication)auth;
    }
  }
  return null;
}
