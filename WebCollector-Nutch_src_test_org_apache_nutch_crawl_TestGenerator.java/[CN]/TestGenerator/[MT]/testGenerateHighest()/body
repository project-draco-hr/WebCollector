{
  final int NUM_RESULTS=2;
  ArrayList<URLCrawlDatum> list=new ArrayList<URLCrawlDatum>();
  for (int i=0; i <= 100; i++) {
    list.add(createURLCrawlDatum("http://aaa/" + pad(i),1,i));
  }
  createCrawlDB(list);
  Path generatedSegment=generateFetchlist(NUM_RESULTS,conf,false);
  Path fetchlist=new Path(new Path(generatedSegment,CrawlDatum.GENERATE_DIR_NAME),"part-00000");
  ArrayList<URLCrawlDatum> l=readContents(fetchlist);
  Collections.sort(l,new ScoreComparator());
  Assert.assertEquals(NUM_RESULTS,l.size());
  Assert.assertEquals("http://aaa/100",(l.get(0).url.toString()));
  Assert.assertEquals("http://aaa/099",(l.get(1).url.toString()));
}
