{
  ArrayList<URLCrawlDatum> list=new ArrayList<URLCrawlDatum>();
  list.add(createURLCrawlDatum("http://a.example.com/index.html",1,1));
  list.add(createURLCrawlDatum("http://b.example.com/index.html",1,1));
  list.add(createURLCrawlDatum("http://c.example.com/index.html",1,1));
  createCrawlDB(list);
  Configuration myConfiguration=new Configuration(conf);
  myConfiguration.setInt(Generator.GENERATOR_MAX_COUNT,2);
  myConfiguration.set(Generator.GENERATOR_COUNT_MODE,Generator.GENERATOR_COUNT_VALUE_DOMAIN);
  Path generatedSegment=generateFetchlist(Integer.MAX_VALUE,myConfiguration,false);
  Path fetchlistPath=new Path(new Path(generatedSegment,CrawlDatum.GENERATE_DIR_NAME),"part-00000");
  ArrayList<URLCrawlDatum> fetchList=readContents(fetchlistPath);
  Assert.assertEquals(1,fetchList.size());
  myConfiguration=new Configuration(myConfiguration);
  myConfiguration.setInt(Generator.GENERATOR_MAX_COUNT,3);
  generatedSegment=generateFetchlist(Integer.MAX_VALUE,myConfiguration,false);
  fetchlistPath=new Path(new Path(generatedSegment,CrawlDatum.GENERATE_DIR_NAME),"part-00000");
  fetchList=readContents(fetchlistPath);
  Assert.assertEquals(2,fetchList.size());
  myConfiguration=new Configuration(myConfiguration);
  myConfiguration.setInt(Generator.GENERATOR_MAX_COUNT,4);
  generatedSegment=generateFetchlist(Integer.MAX_VALUE,myConfiguration,false);
  fetchlistPath=new Path(new Path(generatedSegment,CrawlDatum.GENERATE_DIR_NAME),"part-00000");
  fetchList=readContents(fetchlistPath);
  Assert.assertEquals(3,fetchList.size());
}
