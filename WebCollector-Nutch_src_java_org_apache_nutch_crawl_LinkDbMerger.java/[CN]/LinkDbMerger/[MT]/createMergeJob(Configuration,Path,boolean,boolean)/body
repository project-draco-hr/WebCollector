{
  Path newLinkDb=new Path("linkdb-merge-" + Integer.toString(new Random().nextInt(Integer.MAX_VALUE)));
  JobConf job=new NutchJob(config);
  job.setJobName("linkdb merge " + linkDb);
  job.setInputFormat(SequenceFileInputFormat.class);
  job.setMapperClass(LinkDbFilter.class);
  job.setBoolean(LinkDbFilter.URL_NORMALIZING,normalize);
  job.setBoolean(LinkDbFilter.URL_FILTERING,filter);
  job.setReducerClass(LinkDbMerger.class);
  FileOutputFormat.setOutputPath(job,newLinkDb);
  job.setOutputFormat(MapFileOutputFormat.class);
  job.setBoolean("mapred.output.compress",true);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(Inlinks.class);
  job.setBoolean("mapreduce.fileoutputcommitter.marksuccessfuljobs",false);
  return job;
}
