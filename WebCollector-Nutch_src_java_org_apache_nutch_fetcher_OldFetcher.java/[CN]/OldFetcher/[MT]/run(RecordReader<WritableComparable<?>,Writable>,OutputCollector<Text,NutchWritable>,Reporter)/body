{
  this.input=input;
  this.output=output;
  this.reporter=reporter;
  this.maxRedirect=getConf().getInt("http.redirect.max",3);
  int threadCount=getConf().getInt("fetcher.threads.fetch",10);
  if (LOG.isInfoEnabled()) {
    LOG.info("OldFetcher: threads: " + threadCount);
  }
  for (int i=0; i < threadCount; i++) {
    new FetcherThread(getConf()).start();
  }
  long timeout=getConf().getInt("mapred.task.timeout",10 * 60 * 1000) / 2;
  do {
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
    }
    reportStatus();
synchronized (this) {
      if ((System.currentTimeMillis() - lastRequestStart) > timeout) {
        if (LOG.isWarnEnabled()) {
          LOG.warn("Aborting with " + activeThreads + " hung threads.");
        }
        return;
      }
    }
  }
 while (activeThreads > 0);
}
