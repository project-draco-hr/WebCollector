{
  SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
  long start=System.currentTimeMillis();
  if (LOG.isInfoEnabled()) {
    LOG.info("OldFetcher: starting at " + sdf.format(start));
    LOG.info("OldFetcher: segment: " + segment);
  }
  JobConf job=new NutchJob(getConf());
  job.setJobName("fetch " + segment);
  job.setInt("fetcher.threads.fetch",threads);
  job.set(Nutch.SEGMENT_NAME_KEY,segment.getName());
  job.setSpeculativeExecution(false);
  FileInputFormat.addInputPath(job,new Path(segment,CrawlDatum.GENERATE_DIR_NAME));
  job.setInputFormat(InputFormat.class);
  job.setMapRunnerClass(OldFetcher.class);
  FileOutputFormat.setOutputPath(job,segment);
  job.setOutputFormat(FetcherOutputFormat.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(NutchWritable.class);
  JobClient.runJob(job);
  long end=System.currentTimeMillis();
  LOG.info("OldFetcher: finished at " + sdf.format(end) + ", elapsed: "+ TimingUtil.elapsedTime(start,end));
}
