{
  SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
  long start=System.currentTimeMillis();
  LOG.info("CleaningJob: starting at " + sdf.format(start));
  JobConf job=new NutchJob(getConf());
  FileInputFormat.addInputPath(job,new Path(crawldb,CrawlDb.CURRENT_NAME));
  job.setBoolean("noCommit",noCommit);
  job.setInputFormat(SequenceFileInputFormat.class);
  job.setOutputFormat(NullOutputFormat.class);
  job.setMapOutputKeyClass(ByteWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setMapperClass(DBFilter.class);
  job.setReducerClass(DeleterReducer.class);
  job.setJobName("CleaningJob");
  job.setBoolean(IndexerMapReduce.INDEXER_DELETE,true);
  JobClient.runJob(job);
  long end=System.currentTimeMillis();
  LOG.info("CleaningJob: finished at " + sdf.format(end) + ", elapsed: "+ TimingUtil.elapsedTime(start,end));
}
