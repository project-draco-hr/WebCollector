{
  int contentLength=Integer.MAX_VALUE;
  String contentLengthString=headers.get(Response.CONTENT_LENGTH);
  if (contentLengthString != null) {
    contentLengthString=contentLengthString.trim();
    try {
      if (!contentLengthString.isEmpty())       contentLength=Integer.parseInt(contentLengthString);
    }
 catch (    NumberFormatException e) {
      throw new HttpException("bad content length: " + contentLengthString);
    }
  }
  if (http.getMaxContent() >= 0 && contentLength > http.getMaxContent())   contentLength=http.getMaxContent();
  ByteArrayOutputStream out=new ByteArrayOutputStream(Http.BUFFER_SIZE);
  byte[] bytes=new byte[Http.BUFFER_SIZE];
  int length=0;
  for (int i=in.read(bytes); i != -1 && length + i <= contentLength; i=in.read(bytes)) {
    out.write(bytes,0,i);
    length+=i;
  }
  content=out.toByteArray();
}
