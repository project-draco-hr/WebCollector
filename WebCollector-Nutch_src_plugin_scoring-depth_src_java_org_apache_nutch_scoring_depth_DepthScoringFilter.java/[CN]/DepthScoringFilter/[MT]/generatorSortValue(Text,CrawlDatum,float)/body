{
  int curDepth, curMaxDepth;
  IntWritable maxDepth=(IntWritable)datum.getMetaData().get(MAX_DEPTH_KEY_W);
  if (maxDepth != null) {
    curMaxDepth=maxDepth.get();
  }
 else {
    curMaxDepth=defaultMaxDepth;
  }
  IntWritable depth=(IntWritable)datum.getMetaData().get(DEPTH_KEY_W);
  if (depth == null) {
    curDepth=curMaxDepth;
  }
 else {
    curDepth=depth.get();
  }
  int mul=curMaxDepth - curDepth;
  return initSort * (1 + mul);
}
