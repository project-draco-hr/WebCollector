{
  this.conf=conf;
  String pluginName="urlnormalizer-host";
  Extension[] extensions=PluginRepository.get(conf).getExtensionPoint(URLNormalizer.class.getName()).getExtensions();
  for (int i=0; i < extensions.length; i++) {
    Extension extension=extensions[i];
    if (extension.getDescriptor().getPluginId().equals(pluginName)) {
      attributeFile=extension.getAttribute("file");
      break;
    }
  }
  if (attributeFile != null && attributeFile.trim().equals("")) {
    attributeFile=null;
  }
  if (attributeFile != null) {
    if (LOG.isInfoEnabled()) {
      LOG.info("Attribute \"file\" is defined for plugin " + pluginName + " as "+ attributeFile);
    }
  }
 else {
    if (LOG.isWarnEnabled()) {
      LOG.warn("Attribute \"file\" is not defined in plugin.xml for plugin " + pluginName);
    }
  }
  String file=conf.get("urlnormalizer.hosts.file");
  String stringRules=conf.get("urlnormalizer.hosts.rules");
  if (hostsFile != null) {
    file=hostsFile;
  }
 else   if (attributeFile != null) {
    file=attributeFile;
  }
  Reader reader=null;
  if (stringRules != null) {
    reader=new StringReader(stringRules);
  }
 else {
    reader=conf.getConfResourceAsReader(file);
  }
  try {
    if (reader == null) {
      reader=new FileReader(file);
    }
    readConfiguration(reader);
  }
 catch (  IOException e) {
    LOG.error(org.apache.hadoop.util.StringUtils.stringifyException(e));
  }
}
