{
  InputStream ssInputStream=null;
  ssInputStream=conf.getConfResourceAsInputStream(conf.get(SolrConstants.MAPPING_FILE,"solrindex-mapping.xml"));
  InputSource inputSource=new InputSource(ssInputStream);
  try {
    DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
    DocumentBuilder builder=factory.newDocumentBuilder();
    Document document=builder.parse(inputSource);
    Element rootElement=document.getDocumentElement();
    NodeList fieldList=rootElement.getElementsByTagName("field");
    if (fieldList.getLength() > 0) {
      for (int i=0; i < fieldList.getLength(); i++) {
        Element element=(Element)fieldList.item(i);
        LOG.info("source: " + element.getAttribute("source") + " dest: "+ element.getAttribute("dest"));
        keyMap.put(element.getAttribute("source"),element.getAttribute("dest"));
      }
    }
    NodeList copyFieldList=rootElement.getElementsByTagName("copyField");
    if (copyFieldList.getLength() > 0) {
      for (int i=0; i < copyFieldList.getLength(); i++) {
        Element element=(Element)copyFieldList.item(i);
        LOG.info("source: " + element.getAttribute("source") + " dest: "+ element.getAttribute("dest"));
        copyMap.put(element.getAttribute("source"),element.getAttribute("dest"));
      }
    }
    NodeList uniqueKeyItem=rootElement.getElementsByTagName("uniqueKey");
    if (uniqueKeyItem.getLength() > 1) {
      LOG.warn("More than one unique key definitions found in solr index mapping, using default 'id'");
      uniqueKey="id";
    }
 else     if (uniqueKeyItem.getLength() == 0) {
      LOG.warn("No unique key definition found in solr index mapping using, default 'id'");
    }
 else {
      uniqueKey=uniqueKeyItem.item(0).getFirstChild().getNodeValue();
    }
  }
 catch (  MalformedURLException e) {
    LOG.warn(e.toString());
  }
catch (  SAXException e) {
    LOG.warn(e.toString());
  }
catch (  IOException e) {
    LOG.warn(e.toString());
  }
catch (  ParserConfigurationException e) {
    LOG.warn(e.toString());
  }
}
