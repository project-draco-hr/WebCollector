{
  if (doc == null)   return doc;
  if (dbFieldnames != null) {
    for (    String metatag : dbFieldnames) {
      Text metadata=(Text)datum.getMetaData().get(new Text(metatag));
      if (metadata != null)       doc.add(metatag,metadata.toString());
    }
  }
  if (parseFieldnames != null) {
    for (    String metatag : parseFieldnames.keySet()) {
      for (      String value : parse.getData().getParseMeta().getValues(metatag)) {
        if (value != null)         doc.add(parseFieldnames.get(metatag),value);
      }
    }
  }
  if (contentFieldnames != null) {
    for (    String metatag : contentFieldnames) {
      for (      String value : parse.getData().getContentMeta().getValues(metatag)) {
        if (value != null)         doc.add(metatag,value);
      }
    }
  }
  return doc;
}
