{
  String urlString=url.toString();
  try {
    URL u=new URL(urlString);
    int redirects=0;
    while (true) {
      FileResponse response;
      response=new FileResponse(u,datum,this,getConf());
      int code=response.getCode();
      if (code == 200) {
        return new ProtocolOutput(response.toContent());
      }
 else       if (code == 304) {
        return new ProtocolOutput(response.toContent(),ProtocolStatus.STATUS_NOTMODIFIED);
      }
 else       if (code == 401) {
        return new ProtocolOutput(response.toContent(),new ProtocolStatus(ProtocolStatus.ACCESS_DENIED));
      }
 else       if (code == 404) {
        return new ProtocolOutput(response.toContent(),ProtocolStatus.STATUS_NOTFOUND);
      }
 else       if (code >= 300 && code < 400) {
        if (redirects == MAX_REDIRECTS)         throw new FileException("Too many redirects: " + url);
        u=new URL(response.getHeader("Location"));
        redirects++;
        if (LOG.isTraceEnabled()) {
          LOG.trace("redirect to " + u);
        }
      }
 else {
        throw new FileError(code);
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    return new ProtocolOutput(null,new ProtocolStatus(e));
  }
}
