{
  boolean needInject=true;
  if (resumable && dbManager.isDBExists()) {
    needInject=false;
  }
  if (!resumable) {
    if (dbManager.isDBExists()) {
      dbManager.clear();
    }
    if (seeds.isEmpty() && forcedSeeds.isEmpty()) {
      LOG.info("error:Please add at least one seed");
      return;
    }
  }
  dbManager.open();
  if (needInject) {
    inject();
  }
  if (!forcedSeeds.isEmpty()) {
    injectForcedSeeds();
  }
  status=RUNNING;
  for (int i=0; i < depth; i++) {
    if (status == STOPED) {
      break;
    }
    LOG.info("start depth " + (i + 1));
    long startTime=System.currentTimeMillis();
    if (maxRetry >= 0) {
      generator.setMaxRetry(maxRetry);
    }
 else {
      generator.setMaxRetry(Config.MAX_RETRY);
    }
    generator.setTopN(topN);
    fetcher=new Fetcher();
    fetcher.setRetryInterval(retryInterval);
    fetcher.setVisitInterval(visitInterval);
    fetcher.setDBManager(dbManager);
    fetcher.setRequester(requester);
    fetcher.setVisitor(visitor);
    fetcher.setRetry(retry);
    fetcher.setThreads(threads);
    fetcher.fetchAll(generator);
    long endTime=System.currentTimeMillis();
    long costTime=(endTime - startTime) / 1000;
    int totalGenerate=generator.getTotalGenerate();
    LOG.info("depth " + (i + 1) + " finish: \n\tTOTAL urls:\t"+ totalGenerate+ "\n\tTOTAL time:\t"+ costTime+ " seconds");
    if (totalGenerate == 0) {
      break;
    }
  }
  dbManager.close();
}
