{
  if (datum.getStatus() == CrawlDatum.STATUS_DB_FETCHED || datum.getStatus() == CrawlDatum.STATUS_DB_NOTMODIFIED) {
    try {
      URL url=new URL(urlText.toString());
      String out=null;
switch (mode) {
case MODE_HOST:
        out=url.getHost();
      break;
case MODE_DOMAIN:
    out=URLUtil.getDomainName(url);
  break;
case MODE_SUFFIX:
out=URLUtil.getDomainSuffix(url).getDomain();
break;
case MODE_TLD:
out=URLUtil.getTopLevelDomainName(url);
break;
}
if (out.trim().equals("")) {
LOG.info("url : " + url);
context.getCounter(MyCounter.EMPTY_RESULT).increment(1);
}
context.write(new Text(out),new LongWritable(1));
}
 catch (Exception ex) {
}
context.getCounter(MyCounter.FETCHED).increment(1);
context.write(FETCHED_TEXT,new LongWritable(1));
}
 else {
context.getCounter(MyCounter.NOT_FETCHED).increment(1);
context.write(NOT_FETCHED_TEXT,new LongWritable(1));
}
}
