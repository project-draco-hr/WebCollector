{
  for (int i=0; i < rnd.nextInt(16) + 16; i++) {
    byte expectedStatus=(byte)(rnd.nextInt(6) + 0x21);
    while (expectedStatus == CrawlDatum.STATUS_FETCH_RETRY || expectedStatus == CrawlDatum.STATUS_FETCH_NOTMODIFIED) {
      expectedStatus=(byte)(rnd.nextInt(6) + 0x21);
    }
    byte randomStatus=(byte)(rnd.nextInt(6) + 0x21);
    int rounds=rnd.nextInt(16) + 32;
    boolean withRedirects=rnd.nextBoolean();
    byte resultStatus=executeSequence(randomStatus,expectedStatus,rounds,withRedirects);
    Assert.assertEquals("Expected status = " + CrawlDatum.getStatusName(expectedStatus) + ", but got "+ CrawlDatum.getStatusName(resultStatus)+ " when merging "+ rounds+ " segments"+ (withRedirects ? " with redirects" : ""),expectedStatus,resultStatus);
  }
}
