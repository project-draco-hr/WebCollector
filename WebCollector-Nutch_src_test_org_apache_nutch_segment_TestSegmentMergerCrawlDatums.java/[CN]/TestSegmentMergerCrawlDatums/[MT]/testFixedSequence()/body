{
  Path testDir=new Path(conf.get("hadoop.tmp.dir"),"merge-" + System.currentTimeMillis());
  Path segment1=new Path(testDir,"00001");
  Path segment2=new Path(testDir,"00002");
  Path segment3=new Path(testDir,"00003");
  createSegment(segment1,CrawlDatum.STATUS_FETCH_GONE,false);
  createSegment(segment2,CrawlDatum.STATUS_FETCH_GONE,true);
  createSegment(segment3,CrawlDatum.STATUS_FETCH_SUCCESS,false);
  Path mergedSegment=merge(testDir,new Path[]{segment1,segment2,segment3});
  Byte status=new Byte(status=checkMergedSegment(testDir,mergedSegment));
  Assert.assertEquals(new Byte(CrawlDatum.STATUS_FETCH_SUCCESS),status);
}
