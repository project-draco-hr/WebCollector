{
  Path testDir=new Path(conf.get("hadoop.tmp.dir"),"merge-" + System.currentTimeMillis());
  Path segment1=new Path(testDir,"20140110114943");
  Path segment2=new Path(testDir,"20140110114832");
  Path segment3=new Path(testDir,"20140110114558");
  Path segment4=new Path(testDir,"20140110114930");
  Path segment5=new Path(testDir,"20140110114545");
  Path segment6=new Path(testDir,"20140110114507");
  Path segment7=new Path(testDir,"20140110114903");
  Path segment8=new Path(testDir,"20140110114724");
  createSegment(segment1,CrawlDatum.STATUS_FETCH_SUCCESS,true);
  createSegment(segment2,CrawlDatum.STATUS_FETCH_SUCCESS,true);
  createSegment(segment3,CrawlDatum.STATUS_FETCH_SUCCESS,true);
  createSegment(segment4,CrawlDatum.STATUS_FETCH_SUCCESS,true);
  createSegment(segment5,CrawlDatum.STATUS_FETCH_SUCCESS,true);
  createSegment(segment6,CrawlDatum.STATUS_FETCH_SUCCESS,false);
  createSegment(segment7,CrawlDatum.STATUS_FETCH_SUCCESS,true);
  createSegment(segment8,CrawlDatum.STATUS_FETCH_SUCCESS,true);
  Path mergedSegment=merge(testDir,new Path[]{segment1,segment2,segment3,segment4,segment5,segment6,segment7,segment8});
  Byte status=new Byte(status=checkMergedSegment(testDir,mergedSegment));
  Assert.assertEquals(new Byte(CrawlDatum.STATUS_FETCH_SUCCESS),status);
}
