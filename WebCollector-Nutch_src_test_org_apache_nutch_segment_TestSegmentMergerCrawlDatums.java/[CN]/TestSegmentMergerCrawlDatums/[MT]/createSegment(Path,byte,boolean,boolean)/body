{
  LOG.info("\nSegment: " + segment.toString());
  String url="http://nutch.apache.org/";
  String redirectUrl="http://nutch.apache.org/i_redirect_to_the_root/";
  CrawlDatum value=new CrawlDatum();
  Path crawlFetchPath=new Path(new Path(segment,CrawlDatum.FETCH_DIR_NAME),"part-00000");
  MapFile.Writer writer=new MapFile.Writer(conf,fs,crawlFetchPath.toString(),Text.class,CrawlDatum.class);
  if (redirect) {
    LOG.info(url + " > " + CrawlDatum.getStatusName(CrawlDatum.STATUS_LINKED));
    value=new CrawlDatum();
    value.setStatus(CrawlDatum.STATUS_LINKED);
    writer.append(new Text(url),value);
  }
  if (fetch) {
    LOG.info(url + " > " + CrawlDatum.getStatusName(status));
    value.setStatus(status);
    writer.append(new Text(url),value);
  }
  if (redirect) {
    LOG.info(redirectUrl + " > " + CrawlDatum.getStatusName(CrawlDatum.STATUS_FETCH_REDIR_TEMP));
    value.setStatus(CrawlDatum.STATUS_FETCH_REDIR_TEMP);
    writer.append(new Text(redirectUrl),value);
  }
  writer.close();
}
