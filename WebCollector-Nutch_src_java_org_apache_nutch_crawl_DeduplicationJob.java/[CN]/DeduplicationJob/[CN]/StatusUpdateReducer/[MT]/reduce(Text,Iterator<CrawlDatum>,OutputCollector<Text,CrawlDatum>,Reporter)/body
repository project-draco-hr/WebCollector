{
  boolean duplicateSet=false;
  while (values.hasNext()) {
    CrawlDatum val=values.next();
    if (val.getStatus() == CrawlDatum.STATUS_DB_DUPLICATE) {
      duplicate.set(val);
      duplicateSet=true;
    }
 else {
      old.set(val);
    }
  }
  if (duplicateSet) {
    output.collect(key,duplicate);
    return;
  }
  output.collect(key,old);
}
