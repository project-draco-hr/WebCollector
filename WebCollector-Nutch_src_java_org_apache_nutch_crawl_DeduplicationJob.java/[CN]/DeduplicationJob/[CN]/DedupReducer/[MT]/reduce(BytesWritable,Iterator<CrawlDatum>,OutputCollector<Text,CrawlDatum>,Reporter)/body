{
  CrawlDatum existingDoc=null;
  while (values.hasNext()) {
    if (existingDoc == null) {
      existingDoc=new CrawlDatum();
      existingDoc.set(values.next());
      continue;
    }
    CrawlDatum newDoc=values.next();
    if (existingDoc.getScore() < newDoc.getScore()) {
      writeOutAsDuplicate(existingDoc,output,reporter);
      existingDoc=new CrawlDatum();
      existingDoc.set(newDoc);
      continue;
    }
 else     if (existingDoc.getScore() > newDoc.getScore()) {
      writeOutAsDuplicate(newDoc,output,reporter);
      continue;
    }
    if (existingDoc.getFetchTime() > newDoc.getFetchTime()) {
      writeOutAsDuplicate(newDoc,output,reporter);
      continue;
    }
 else     if (existingDoc.getFetchTime() < newDoc.getFetchTime()) {
      writeOutAsDuplicate(existingDoc,output,reporter);
      existingDoc=new CrawlDatum();
      existingDoc.set(newDoc);
      continue;
    }
    String urlExisting=existingDoc.getMetaData().get(urlKey).toString();
    String urlnewDoc=newDoc.getMetaData().get(urlKey).toString();
    if (urlExisting.length() < urlnewDoc.length()) {
      writeOutAsDuplicate(newDoc,output,reporter);
      continue;
    }
 else     if (urlExisting.length() > urlnewDoc.length()) {
      writeOutAsDuplicate(existingDoc,output,reporter);
      existingDoc=new CrawlDatum();
      existingDoc.set(newDoc);
      continue;
    }
  }
}
