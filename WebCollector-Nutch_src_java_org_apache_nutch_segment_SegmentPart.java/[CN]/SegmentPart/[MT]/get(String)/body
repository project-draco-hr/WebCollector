{
  String dir=path.replace('\\','/');
  int idx=dir.lastIndexOf("/part-");
  if (idx == -1) {
    throw new IOException("Cannot determine segment part: " + dir);
  }
  dir=dir.substring(0,idx);
  idx=dir.lastIndexOf('/');
  if (idx == -1) {
    throw new IOException("Cannot determine segment part: " + dir);
  }
  String part=dir.substring(idx + 1);
  dir=dir.substring(0,idx);
  idx=dir.lastIndexOf('/');
  if (idx == -1) {
    throw new IOException("Cannot determine segment name: " + dir);
  }
  String segment=dir.substring(idx + 1);
  return new SegmentPart(segment,part);
}
