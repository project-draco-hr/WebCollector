{
  SequenceFile.Reader[] readers=SequenceFileOutputFormat.getReaders(getConf(),dir);
  ArrayList<Writable> res=new ArrayList<Writable>();
  Class<?> keyClass=readers[0].getKeyClass();
  Class<?> valueClass=readers[0].getValueClass();
  if (!keyClass.getName().equals("org.apache.hadoop.io.Text"))   throw new IOException("Incompatible key (" + keyClass.getName() + ")");
  Writable aKey=(Writable)keyClass.newInstance();
  Writable value=(Writable)valueClass.newInstance();
  for (int i=0; i < readers.length; i++) {
    while (readers[i].next(aKey,value)) {
      if (aKey.equals(key)) {
        res.add(value);
        value=(Writable)valueClass.newInstance();
      }
    }
    readers[i].close();
  }
  return res;
}
