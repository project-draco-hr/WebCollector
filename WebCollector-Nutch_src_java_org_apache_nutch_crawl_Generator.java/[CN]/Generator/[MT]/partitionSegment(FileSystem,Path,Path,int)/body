{
  if (LOG.isInfoEnabled()) {
    LOG.info("Generator: Partitioning selected urls for politeness.");
  }
  Path segment=new Path(segmentsDir,generateSegmentName());
  Path output=new Path(segment,CrawlDatum.GENERATE_DIR_NAME);
  LOG.info("Generator: segment: " + segment);
  NutchJob job=new NutchJob(getConf());
  job.setJobName("generate: partition " + segment);
  job.setInt("partition.url.seed",new Random().nextInt());
  FileInputFormat.addInputPath(job,inputDir);
  job.setInputFormat(SequenceFileInputFormat.class);
  job.setMapperClass(SelectorInverseMapper.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(SelectorEntry.class);
  job.setPartitionerClass(URLPartitioner.class);
  job.setReducerClass(PartitionReducer.class);
  job.setNumReduceTasks(numLists);
  FileOutputFormat.setOutputPath(job,output);
  job.setOutputFormat(SequenceFileOutputFormat.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(CrawlDatum.class);
  job.setOutputKeyComparatorClass(HashComparator.class);
  JobClient.runJob(job);
  return segment;
}
