{
  this.conf=conf;
  String pluginName="urlfilter-prefix";
  Extension[] extensions=PluginRepository.get(conf).getExtensionPoint(URLFilter.class.getName()).getExtensions();
  for (int i=0; i < extensions.length; i++) {
    Extension extension=extensions[i];
    if (extension.getDescriptor().getPluginId().equals(pluginName)) {
      attributeFile=extension.getAttribute("file");
      break;
    }
  }
  if (attributeFile != null && attributeFile.trim().equals(""))   attributeFile=null;
  if (attributeFile != null) {
    if (LOG.isInfoEnabled()) {
      LOG.info("Attribute \"file\" is defined for plugin " + pluginName + " as "+ attributeFile);
    }
  }
 else {
  }
  String file=conf.get("urlfilter.prefix.file");
  String stringRules=conf.get("urlfilter.prefix.rules");
  if (attributeFile != null)   file=attributeFile;
  Reader reader=null;
  if (stringRules != null) {
    reader=new StringReader(stringRules);
  }
 else {
    reader=conf.getConfResourceAsReader(file);
  }
  if (reader == null) {
    trie=new PrefixStringMatcher(new String[0]);
  }
 else {
    try {
      trie=readConfiguration(reader);
    }
 catch (    IOException e) {
      if (LOG.isErrorEnabled()) {
        LOG.error(e.getMessage());
      }
      throw new RuntimeException(e.getMessage(),e);
    }
  }
}
